<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”® éš¨ç·£å ‚ | çŸ¥å‘½éš¨ç·£ï¼Œå‰µé€ ç„¡é™</title>
    <style>
        /* CSS: æœ€çµ‚ç¾åŒ–èˆ‡æ’ç‰ˆ */
        :root {
            --primary-color: #5d35b6; /* ä¸»ç´«è‰² (æ™ºæ…§) */
            --secondary-color: #7c4dff; /* äº®ç´«è‰² */
            --red-accent: #c62828; /* ä¸­åœ‹ç´… (å¼·èª¿/ç†±æƒ…) */
            --bg-light: #f8f7ff;
            --text-dark: #333;
            --text-light: white;
            --card-bg: #fff;
            --shadow-subtle: 0 4px 12px rgba(0, 0, 0, 0.08); /* æŸ”å’Œé™°å½± */
        }

        body { 
            font-family: 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif; 
            margin: 0; 
            padding: 0; 
            background-color: var(--bg-light); 
            color: var(--text-dark); 
            line-height: 1.8;
            scroll-behavior: smooth; /* å¹³æ»‘æ»¾å‹• */
        }
        header { 
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); 
            color: var(--text-light); 
            padding: 40px 0; 
            text-align: center; 
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2); 
        }
        header h1 { margin: 0; font-size: 3.0em; font-weight: 700; }
        header p { margin: 8px 0 0; font-size: 1.3em; opacity: 0.9; }
        
        nav { 
            background-color: #4a148c; 
            text-align: center; 
            padding: 10px 0; 
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        nav a { 
            color: var(--text-light); 
            text-decoration: none; 
            padding: 10px 25px; 
            display: inline-block; 
            transition: background-color 0.3s, color 0.3s; 
            font-weight: 500;
        }
        nav a:hover { 
            background-color: var(--red-accent); 
            color: white;
        }

        .container { 
            width: 90%; 
            max-width: 1200px; 
            margin: 40px auto; 
            padding: 40px; 
            background-color: var(--card-bg); 
            border-radius: 12px; 
            box-shadow: var(--shadow-subtle); 
        }
        h2 { 
            color: var(--primary-color); 
            border-bottom: 4px solid var(--red-accent); 
            padding-bottom: 15px; 
            margin-top: 0; 
            font-size: 2.2em;
            text-align: center;
            font-weight: 600;
        }
        h3 { 
            color: var(--primary-color); 
            margin-top: 30px; 
            font-size: 1.7em;
            border-left: 5px solid var(--secondary-color);
            padding-left: 15px;
        }
        
        /* å‘½ç†é‡è¦æ€§å€å¡Š (ç´…è‰²å¡ç‰‡) */
        .importance-card {
            background-color: #ffebee; 
            border-left: 10px solid var(--red-accent); 
            border-radius: 12px;
            padding: 30px;
            margin-top: 40px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            display: flex;
            gap: 30px;
        }
        .importance-card h3 {
            color: var(--red-accent); 
            border: none;
            padding-left: 0;
        }
        .importance-card ul {
            list-style: none;
            padding-left: 20px;
        }
        .importance-card li {
            position: relative;
            margin-bottom: 15px;
            padding-left: 15px;
        }
        .importance-card li::before {
            content: 'â˜…';
            color: var(--red-accent);
            font-weight: bold;
            position: absolute;
            left: 0;
        }

        /* è¡¨å–®/å·¥å…·å€å¡Š */
        .tool-box, form { 
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .tool-box {
            background-color: #e3f2fd;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 25px;
        }
        input[type="date"], input[type="time"], input[type="text"], input[type="email"], textarea { 
            background-color: white;
            border: 1px solid #b39ddb;
            padding: 12px; 
            border-radius: 6px;
            font-size: 1em;
            transition: border-color 0.3s;
        }
        input:focus, textarea:focus {
            border-color: var(--primary-color);
            outline: none;
        }
        
        button { 
            background-color: var(--red-accent); 
            color: var(--text-light); 
            padding: 12px 30px; 
            border: none; 
            border-radius: 50px; 
            cursor: pointer; 
            font-size: 1.1em; 
            font-weight: bold;
            transition: background-color 0.3s, transform 0.2s; 
            margin-top: 10px;
        }
        button:hover { 
            background-color: #e53935; 
            transform: translateY(-2px); 
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        /* æ–‡ç« åˆ—è¡¨/å…§å®¹ */
        .article-list {
            list-style: none;
            padding: 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 20px;
            margin-top: 30px;
        }
        .article-list li {
            background-color: #f3e5f5; 
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            transition: box-shadow 0.3s, background-color 0.3s;
        }
        .article-list li:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            background-color: #ede7f6;
        }
        .article-list a {
            color: var(--primary-color); 
            text-decoration: none; 
            display: block;
        }
        .article-list a:hover {
            text-decoration: underline;
            color: var(--red-accent);
        }

        .article-content { 
            padding-top: 50px; 
            margin-top: 50px;
            border-top: 2px dashed #eee;
            display: block;
        }
        .article-content a { color: var(--red-accent); }
        .article-content .key-point { 
            background-color: #fffde7; 
            border-left: 5px solid var(--accent-color); 
            padding: 20px;
            margin: 20px 0;
            border-radius: 6px;
        }
        
        /* å…«å­—è¡¨æ ¼ */
        .bazi-table { 
            width: 100%; 
            border-collapse: collapse; 
            margin-top: 15px; 
            text-align: center;
        }
        .bazi-table th, .bazi-table td {
            border: 1px solid #ccc; 
            padding: 10px;
        }
        .bazi-table th { 
            background-color: var(--primary-color); 
            color: white; 
            font-weight: bold;
        }

        footer { 
            background-color: #333; 
            color: white; 
            text-align: center; 
            padding: 20px 0; 
            margin-top: 50px; 
            font-size: 0.9em; 
        }

    </style>

    <script>
        // === JavaScript: å…«å­—æ’ç›¤æ¼”ç®—æ³• (V3.1 ä¿®æ­£ç‰ˆ) ===
        const TIAN_GAN = ["ç”²", "ä¹™", "ä¸™", "ä¸", "æˆŠ", "å·±", "åºš", "è¾›", "å£¬", "ç™¸"];
        const DI_ZHI = ["å­", "ä¸‘", "å¯…", "å¯", "è¾°", "å·³", "åˆ", "æœª", "ç”³", "é…‰", "æˆŒ", "äº¥"];

        // 1. æ—¥æŸ±å¹²æ”¯è¨ˆç®—
        function calculateDayGanZhi(dateStr) {
            const dateFromEpoch = new Date(dateStr);
            const epoch = new Date('1899-12-31');
            const days = Math.floor((dateFromEpoch - epoch) / (1000 * 60 * 60 * 24));
            const ganIndex = (5 + days) % 10;
            const zhiIndex = (11 + days) % 12;
            return { gan: TIAN_GAN[ganIndex], zhi: DI_ZHI[zhiIndex] };
        }

        // 2. å¹´æŸ±å¹²æ”¯è¨ˆç®—
        function calculateYearGanZhi(year) {
            const offsetYear = year - 1984;
            const ganIndex = (offsetYear % 10 + 10) % 10;
            const zhiIndex = (offsetYear % 12 + 12) % 12;
            return { gan: TIAN_GAN[ganIndex], zhi: DI_ZHI[zhiIndex] };
        }

        // 3. æ™‚æŸ±å¹²æ”¯è¨ˆç®— (äº”é¼ éæ—¥æ­Œä¿®æ­£ç‰ˆ)
        function calculateHourGanZhi(dayGan, timeStr) {
            const hour = parseInt(timeStr.split(':')[0]);
            let hourZhiIndex;
            if (hour >= 23 || hour < 1) { 
                hourZhiIndex = 0; // å­æ™‚
            } else {
                hourZhiIndex = Math.floor((hour + 1) / 2) % 12;
            }
            const hourZhi = DI_ZHI[hourZhiIndex];

            const dayGanMap = { "ç”²": 0, "å·±": 0, "ä¹™": 2, "åºš": 2, "ä¸™": 4, "è¾›": 4, "ä¸": 6, "å£¬": 6, "æˆŠ": 8, "ç™¸": 8 };
            const zishiGanIndex = dayGanMap[dayGan]; 
            const hourGanIndex = (zishiGanIndex + hourZhiIndex) % 10;
            const hourGan = TIAN_GAN[hourGanIndex]; 

            return { gan: hourGan, zhi: hourZhi };
        }
        
        // 4. æœˆæŸ±å¹²æ”¯è¨ˆç®— (ç°¡åŒ–ç‰ˆ)
        function calculateMonthGanZhi(year, month) {
            const yearGan = calculateYearGanZhi(year).gan;
            const yearGanMap = { "ç”²": 2, "å·±": 2, "ä¹™": 4, "åºš": 4, "ä¸™": 6, "è¾›": 6, "ä¸": 8, "å£¬": 8, "æˆŠ": 0, "ç™¸": 0 };

            const zhiIndex = (month + 10) % 12; 
            const monthZhi = DI_ZHI[zhiIndex];
            
            const yinYueGanIndex = yearGanMap[yearGan]; 
            const monthGanIndex = (yinYueGanIndex + zhiIndex - 2 + 10) % 10; 
            const monthGan = TIAN_GAN[monthGanIndex];

            return { gan: monthGan, zhi: monthZhi };
        }


        // 5. æ•´åˆé¡¯ç¤ºå‡½æ•¸ (è¢«æŒ‰éˆ•å‘¼å«)
        function generateBazi() {
            const dateStr = document.getElementById('birthDate').value;
            const timeStr = document.getElementById('birthTime').value;
            const resultDiv = document.getElementById('baziResult');
            
            try {
                if (!dateStr || !timeStr) {
                    resultDiv.innerHTML = '<p style="color: var(--red-accent); font-weight: bold;">è«‹è¼¸å…¥å®Œæ•´çš„å‡ºç”Ÿæ—¥æœŸå’Œæ™‚é–“ï¼</p>';
                    return;
                }

                const date = new Date(dateStr);
                const year = date.getFullYear();
                const month = date.getMonth() + 1;

                const dayGanZhi = calculateDayGanZhi(dateStr);
                const yearGanZhi = calculateYearGanZhi(year);
                const hourGanZhi = calculateHourGanZhi(dayGanZhi.gan, timeStr);
                const monthGanZhi = calculateMonthGanZhi(year, month); 

                const mockResult = `
                    <h4 style="color: var(--red-accent); font-size: 1.4em; text-align: center;">âœ… å…«å­—æ’ç›¤çµæœ (ç³»çµ±è¨ˆç®—ç‰ˆ)</h4>
                    <p style="text-align: center;">
                        <strong>æ—¥ä¸»ï¼ˆå‘½ä¸»ï¼‰ç‚ºï¼š</strong><strong style="color: var(--primary-color); font-size: 1.5em;">${dayGanZhi.gan}</strong>
                        <span style="display: block; font-size: 0.9em; color: #777;">ï¼ˆæ‚¨çš„æ ¸å¿ƒå€‹æ€§èˆ‡æœ¬è³ªï¼‰</span>
                    </p>
                    <table class="bazi-table">
                        <tr><th>æŸ±</th><th>å¹´æŸ±</th><th>æœˆæŸ±</th><th>æ—¥æŸ±</th><th>æ™‚æŸ±</th></tr>
                        <tr><td>å¤©å¹²</td><td>${yearGanZhi.gan}</td><td>${monthGanZhi.gan}</td><td>${dayGanZhi.gan}</td><td>${hourGanZhi.gan}</td></tr>
                        <tr><td>åœ°æ”¯</td><td>${yearGanZhi.zhi}</td><td>${monthGanZhi.zhi}</td><td>${dayGanZhi.zhi}</td><td>${hourGanZhi.zhi}</td></tr>
                    </table>
                    <p style="margin-top: 20px; font-style: italic; color: #00796b;">
                        *æ³¨æ„ï¼šæ™‚æŸ±é‚è¼¯ (äº”é¼ éæ—¥æ­Œ) å·²ä¿®æ­£ç‚ºç²¾ç¢ºç‰ˆã€‚
                    </p>
                `;
                
                resultDiv.innerHTML = mockResult;

                // ã€æ ¸å¿ƒä¿®æ­£ V3.2ã€‘æ’ç›¤å®Œæˆå¾Œï¼Œè‡ªå‹•æ²å‹•åˆ°çµæœå€å¡Š
                document.getElementById('baziResult').scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'center' 
                });

            } catch(e) {
                // å¦‚æœè¨ˆç®—å‡ºéŒ¯ï¼Œé¡¯ç¤ºéŒ¯èª¤ä¿¡æ¯
                resultDiv.innerHTML = `<p style="color: var(--red-accent); font-weight: bold;">å…«å­—æ’ç›¤è¨ˆç®—å¤±æ•—ï¼è«‹æª¢æŸ¥æ—¥æœŸæ˜¯å¦æ­£ç¢ºã€‚</p><p style="font-size: 0.8em; color: #777;">éŒ¯èª¤è©³æƒ…: ${e.message}</p>`;
